<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<link rel="stylesheet" href="/web/resources/css/back.css" />
		<link rel="stylesheet" href="/web/resources/css/bootstrap.min.css" type="text/css" />
		<script src="/web/resources/js/jquery-1.11.3.min.js" type="text/javascript"></script>
		<script src="/web/resources/js/bootstrap.min.js" type="text/javascript"></script>
		<script type="text/javascript" src="/web/resources/js/jquery-heima-0.0.1.js" ></script>
		<script type="text/javascript" src="/web/resources/js/vue.js"></script>
		<title>商品列表</title>
		<style type="text/css">
			.prod_tr{
				text-align: center;
			}
			.prod_tr:hover{
				background-color: white;
			}

		</style>
		<script type="text/javascript">
			$(function(){
				// 构建vue对象
				var vueProductList = new Vue({
					el:"#plist",
					data:{
						 pageBean:{},
					},
					methods:{
						initProductData(){
							var currentPage = HM.getParameter("currentPage");
							if(currentPage == null){
								currentPage = 1;
							}
							HM.ajax("/admin","method=getProductsByPage&currentPage="+currentPage,function(data,state,xhr){
								if(data.code == 1){
									vueProductList.pageBean = data.obj;
									var pageHtml = HM.page(data.obj,"/web/view/admin/product/list.html");
									$("#page").html(pageHtml);
								}else{
									console.log(data);
								}
							})
						},
						verifyIsLogin(){
							HM.ajax("/admin","method=isLogin",function (data,state,xhr){
								if(data.code == 1){
									vueProductList.initProductData();
									console.log(data.message)
								}else{
									console.log(data);
									$("body").html("未登录");
								}
							})
						},
					},
					mounted:function(){
						this.verifyIsLogin();
					}
				});
			});
		</script>
	</head>
	<body>
		<table cellSpacing="1" cellPadding="0" width="100%" align="center" bgColor="#f5fafe" border="0">
				<tbody>
					<tr>
						<td  align="center" bgColor="#afd1f3">
							<strong>商品列表</strong>
						</TD>
					</tr>
					<tr>
						<td  align="right">
							<a href="/web/view/admin/product/add.html" target="mainFrame">添加</a>
						</td>
					</tr>
					<tr>
						<td  align="center" bgColor="#f5fafe">
							<table id="plist" cellspacing="0" cellpadding="1" bordercolor="gray" border="1" style=" WIDTH: 100%; WORD-BREAK: break-all;BORDER-COLLAPSE: collapse; WORD-WRAP: break-word">
								<tr style="FONT-WEIGHT: bold; FONT-SIZE: 12pt; HEIGHT: 25px; BACKGROUND-COLOR: #afd1f3;text-align: center;">
									<td width="7%">
										序号
									</td>
									<td  width="10%">
										商品名称
									</td>
									<td  width="47%">
										商品描述
									</td>
									<td  width="17%">
										商品价格
									</td>
									<td  width="10%">
										是否热门
									</td>
									<td  >
										商品图片
									</td>

								</tr>

								<template v-for="(product,index) in pageBean.list"  >
									<tr :class="{'tr_odd prod_tr':index%2!=0,'tr_even prod_tr':index%2==0}">
										<td >
											{{product.pid}}
										</td>
										<td >
											{{product.pname}}
										</td>
										<td align="left" >
											{{product.pdesc}}
										</td>
										<td >
											{{product.shop_price}}
										</td>
										<td >
											{{product.is_hot}}
										</td>
										<td >
											<img width="40" :src="'/web/'+product.pimage">
										</td>
									</tr>
								</template>


							</table>
						</td>
					</tr>
					<tr align="center">
						<td colspan="7">
								<nav aria-label="Page navigation">
								  <ul class="pagination" id="page">

								    <li class="disabled">
								      <a href="#" aria-label="Previous">
								        <span aria-hidden="true">&laquo;</span>
								      </a>
								    </li>
								    <li class="active"><a href="#">1</a></li>
								    <li><a href="#">2</a></li>
								    <li><a href="#">3</a></li>
								    <li><a href="#">4</a></li>
								    <li><a href="#">5</a></li>
								    <li>
								      <a href="#" aria-label="Next">
								        <span aria-hidden="true">&raquo;</span>
								      </a>
								    </li>

								  </ul>
								</nav>
						</td>
					</tr>
				</tbody>
			</table>
	</body>
</html>
