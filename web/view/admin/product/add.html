<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
				<link rel="stylesheet" href="/web/resources/css/back.css" />
		<link rel="stylesheet" href="/web/resources/css/bootstrap.min.css" type="text/css" />
		<script src="/web/resources/js/jquery-1.11.3.min.js" type="text/javascript"></script>
		<script src="/web/resources/js/bootstrap.min.js" type="text/javascript"></script>
		<script type="text/javascript" src="/web/resources/js/jquery-heima-0.0.1.js" ></script>
		<script type="text/javascript" src="/web/resources/js/vue.js"></script>
		<script type="text/javascript">
			$(function(){
				var vueProduct = new Vue({
					el:"#productForm",
					data:{
						categoryList:[]
					},
					methods:{
						initProductData(){
							 // 获取下拉列表数据
							 HM.ajax("/category","method=findAll",function(data,state,xhr){
								 if(data.code == 1){
									 vueProduct.categoryList = data.obj;
								 }else{
									 console.log(data);
								 }
							 })
						},
						addProduct(){
							HM.ajaxFile("/fileuploadAndproduct","productForm",function(data,state,xhr){
								if(data.code == 1){
									location.href = "/web/view/admin/product/list.html";
								}else{
									console.log(data);
									alert(data.message);
								}
							})
						},
						verifyIsLogin(){
							HM.ajax("/admin","method=isLogin",function (data,state,xhr){
								if(data.code == 1){
									vueProduct.initProductData();
									console.log(data.message)
								}else{
									console.log(data);
									$("body").html("未登录");
								}
							})
						},
					},
					mounted:function(){
						this.verifyIsLogin();
					}

				});
			});


		</script>
	</head>
	<body>
		<!--
        	enctype="multipart/form-data"
        -->
		<form id="productForm"  method="post" enctype="multipart/form-data">
			&nbsp;
			<input type="hidden" name="method" value="addProduct" />
			<table cellSpacing="1" cellPadding="5" width="100%" align="center" bgColor="#eeeeee" style="border: 1px solid #8ba7e3" border="0">
				<tr>
					<td  align="center" bgColor="#afd1f3" colSpan="4"
						height="26">
						<STRONG>添加商品</STRONG>
					</td>
				</tr>

				<tr>
					<td width="18%" align="center" bgColor="#f5fafe" >
						商品名称：
					</td>
					<td  bgColor="#ffffff">
						<input type="text" name="pname" value=""  class="bg"/>
					</td>
					<td width="18%" align="center" bgColor="#f5fafe" >
						是否热门：
					</td>
					<td  bgColor="#ffffff">
						<select name="is_hot">
							<option value="1">是</option>
							<option value="0">否</option>
						</select>
					</td>
				</tr>
				<tr>
					<td width="18%" align="center" bgColor="#f5fafe" >
						市场价格：
					</td>
					<td  bgColor="#ffffff">
						<input type="text" name="market_price" value=""  class="bg"/>
					</td>
					<td width="18%" align="center" bgColor="#f5fafe" >
						商城价格：
					</td>
					<td  bgColor="#ffffff">
						<input type="text" name="shop_price" value="" class="bg"/>
					</td>
				</tr>
				<tr>
					<td width="18%" align="center" bgColor="#f5fafe" >
						商品图片：
					</td>
					<td bgColor="#ffffff" colspan="3">
						<input type="file" name="pimage" />
					</td>
				</tr>
				<tr>
					<td width="18%" align="center" bgColor="#f5fafe" >
						所属的分类：
					</td>
					<td  bgColor="#ffffff" colspan="3">
						<select name="cid" id="cid">
							<option value="">--请选择--</option>

							<template v-for="category in categoryList">
								<option :value="category.cid">{{category.cname}}</option>
							</template>

						</select>
					</td>
				</tr>
				<tr>
					<td width="18%" align="center" bgColor="#f5fafe" >
						商品描述：
					</td>
					<td  bgColor="#ffffff" colspan="3">
						<textarea name="pdesc" rows="5" cols="30"></textarea>
					</td>
				</tr>
				<tr>
					<td  style="WIDTH: 100%" align="center"
						bgColor="#f5fafe" colSpan="4">
						<button  type="button" id="save" @click="addProduct()">
							确定
						</button>
						<FONT face="宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT>
						<button type="reset" >重置</button>
						<FONT face="宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT>
						<INPUT  type="button" onclick="history.go(-1)" value="返回"/>
					</td>
				</tr>
			</table>
		</form>
	</body>
</html>
